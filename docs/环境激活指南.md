# Pyt 项目环境激活指南

本文档介绍了如何确保每次打开终端都能自动使用正确的虚拟环境。

## 🎯 目标

- 自动激活 `pyt-env` Conda 环境
- 自动设置 `PYTHONPATH` 为项目的 `src` 目录
- 提供便捷的项目启动命令

## 📋 已实施的解决方案

### 方案一：PowerShell 配置文件自动激活（推荐）

**状态：✅ 已实施**

配置文件位置：`C:\Users\Lenovo\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1`

**功能：**
- 检测到在 Pyt 项目目录时自动激活 `pyt-env` 环境
- 自动设置 `PYTHONPATH`
- 提供便捷的启动命令函数

**可用函数：**
```powershell
# 手动激活环境
Activate-PytEnv

# 启动后端服务
Start-PytBackend

# 启动前端服务
Start-PytFrontend
```

**使用方法：**
1. 打开新的 PowerShell 终端
2. 导航到项目目录（会自动激活环境）
3. 或者手动运行 `Activate-PytEnv`

### 方案二：项目根目录脚本

**状态：✅ 已实施**

#### 详细激活脚本：`activate_env.ps1`

```powershell
.\activate_env.ps1
```

**功能：**
- 完整的环境检查和验证
- 详细的错误处理和提示
- 显示环境信息和可用命令

#### 快速激活脚本：`quick_env.ps1`

```powershell
.\quick_env.ps1
```

**功能：**
- 一键快速激活环境
- 简洁的成功提示

## 🔧 验证环境激活

运行以下命令验证环境是否正确激活：

```powershell
# 检查当前环境
echo $env:CONDA_DEFAULT_ENV

# 检查 Python 版本
python --version

# 检查 PYTHONPATH
echo $env:PYTHONPATH
```

**预期输出：**
```
pyt-env
Python 3.10.13
F:\Code\PythonCode\Pyt\src;
```

## 🚀 项目启动命令

### 后端服务
```powershell
# 方法1：使用配置文件函数
Start-PytBackend

# 方法2：手动启动
python -m uvicorn src.api.app:app --reload --port 8000
```

### 前端服务
```powershell
# 方法1：使用配置文件函数
Start-PytFrontend

# 方法2：手动启动
cd frontend
python -m http.server 3000
```

### 运行测试
```powershell
pytest tests/
```

## 📝 最佳实践

1. **推荐使用方案一**：PowerShell 配置文件自动激活，一次配置永久生效
2. **备用方案**：使用项目根目录的脚本文件
3. **团队协作**：将脚本文件加入版本控制，团队成员统一使用
4. **定期检查**：定期验证环境配置是否正确

## 🔍 故障排除

### 问题1：PowerShell 执行策略限制

**解决方案：**
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 问题2：conda 命令未找到

**解决方案：**
1. 确保 Anaconda/Miniconda 已安装
2. 重新初始化 conda：`conda init powershell`
3. 重启终端

### 问题3：环境未自动激活

**解决方案：**
1. 手动重新加载配置文件：`. $PROFILE`
2. 或使用备用脚本：`.\quick_env.ps1`

## 📊 实施状态

- ✅ PowerShell 配置文件创建
- ✅ 自动环境激活功能
- ✅ 项目快捷命令
- ✅ 备用激活脚本
- ✅ 环境验证测试
- ✅ 使用文档

---

**更新时间：** 2024年12月
**维护者：** Pyt 项目团队